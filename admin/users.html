<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Admin — Users</title>
</head>
<body>
<h1>Utilisateurs</h1>
<div id="list"></div>

<script type="module">
  import { db } from "../_shared/firebase.js";
  import { requireAdmin } from "../_shared/guard.js";
  import { collection,getDocs } from
    "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  const list=document.getElementById("list");

  async function load(){
    const snap=await getDocs(collection(db,"users"));
    list.innerHTML="";
    snap.forEach(d=>{
      const u=d.data();
      list.innerHTML+=`${u.email} — ${u.role}<br>`;
    });
  }

  requireAdmin({redirectTo:"../index.html",onOk:load});
</script>
</body>
</html>
