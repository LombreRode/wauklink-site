<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Annonces</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../style.css">
</head>
<body>

<h1>Annonces</h1>
<div id="list">Chargement…</div>

<script type="module">
  import { db } from "../_shared/firebase.js";
  import { collection, getDocs, query, where } from
    "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

  const list = document.getElementById("list");

  async function load(){
    const q = query(
      collection(db,"annonces_location"),
      where("status","==","active")
    );
    const snap = await getDocs(q);
    list.innerHTML = "";

    if (snap.empty){
      list.textContent = "Aucune annonce disponible.";
      return;
    }

    snap.forEach(d=>{
      const a=d.data();
      const div=document.createElement("div");
      div.className="card";
      div.innerHTML=`
        <h3>${a.titre || "Annonce"}</h3>
        <p>${a.ville || ""}</p>
        <p>${a.prix || ""} €</p>
      `;
      list.appendChild(div);
    });
  }

  load();
</script>

<script type="module" src="../auth/status.js"></script>
</body>
</html>
